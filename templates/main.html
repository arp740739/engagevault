<script>
async function connectWithX() {
    const button = document.querySelector('.twitter-button');
    try {
        console.log("Starting X connection..."); // Debug log
        button.classList.add('loading');
        
        const response = await fetch('/auth/twitter');
        console.log("Response received:", response); // Debug log
        
        const data = await response.json();
        console.log("Data received:", data); // Debug log
        
        if (data.success && data.auth_url) {
            console.log("Redirecting to:", data.auth_url); // Debug log
            window.location.href = data.auth_url;
        } else {
            console.error("Error data:", data); // Debug log
            document.querySelector('.error-message').textContent = data.message || 'Error connecting to X';
        }
    } catch (error) {
        console.error('Connection error:', error); // Debug log
        document.querySelector('.error-message').textContent = 'Connection error';
    } finally {
        button.classList.remove('loading');
    }
}
</script>